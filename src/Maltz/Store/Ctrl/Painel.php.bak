<?php

namespace Maltz\Store\Ctrl;

class Painel extends Controller {

    private $modelo;
    private $dados;

    public function __construct($db) {
        $this->db = $db;
    }

    public function carregar() {

        // contagens de cada componente
        $pedidos = new Pedido($this->db);
        $pages = new Pagina($this->db);
        $produtos = new Produto($this->db);
        $fotos = new Foto($this->db);
        $albums = new Galeria($this->db);
        $clientes = new Cliente($this->db);



        // ultimas 5 entradas do Log
        $log = new Log($this->db);
        $log->listar(5, 1);
        $this->dados = array(
            'log' => $log->getDados(),
            'nums' => array(
                'produtos' => $produtos->contar(),
                'pages' => $paginas->contar(),
                'pedidos' => $pedidos->contar(),
                'fotos' => $fotos->contar(),
                'albums' => $albums->contar(),
                'clientes' => $clientes->contar()
            )
        );
    }

    public function render() {
        return html('admin/painel.tpl.php', 'layouts/admin.layout.tpl.php');
    }

}

?>
